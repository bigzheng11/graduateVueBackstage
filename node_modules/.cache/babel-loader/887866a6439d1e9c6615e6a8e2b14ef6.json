{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport default {\n  data() {\n    return {\n      //定时器\n      num: 0,\n      timer: null,\n      //用户信息\n      user: {},\n      // echarts的数据配置项\n      option: {\n        // 中间大标题\n        title: {\n          text: \"用户15518745323\",\n          subtext: \"购买倾向图\",\n          left: \"center\"\n        },\n        tooltip: {\n          trigger: \"item\"\n        },\n        legend: {\n          orient: \"vertical\",\n          left: \"left\"\n        },\n        series: [{\n          name: \"Access From\",\n          type: \"pie\",\n          radius: \"50%\",\n          data: [],\n          emphasis: {\n            itemStyle: {\n              shadowBlur: 10,\n              shadowOffsetX: 0,\n              shadowColor: \"rgba(0, 0, 0, 0.5)\"\n            }\n          }\n        }]\n      }\n    };\n  },\n\n  created() {\n    console.log(\"\"); //获取用户信息:\n    //   this.user = this.$qs.parse(window.sessionStorage.getItem(\"userinfo\"));\n\n    this.$axios.get(\"/api/interest/backstage/15518745323\").then(response => {\n      console.log(response.data);\n      let temp = {};\n\n      for (const item of response.data) {\n        temp.name = item.goodsClassify;\n        temp.value = item.grade;\n        this.option.series[0].data.push(temp);\n        temp = {};\n      }\n\n      var chartDom = document.getElementById(\"main\");\n      var myChart = this.$echarts.init(chartDom);\n      this.option && myChart.setOption(this.option);\n    }).catch(error => {}); // 实现轮询\n\n    this.timer = window.setInterval(() => {\n      setTimeout(this.getProjectList(), 0);\n    }, 1000);\n  },\n\n  mounted() {\n    var chartDom = document.getElementById(\"main\");\n    var myChart = this.$echarts.init(chartDom);\n    this.option && myChart.setOption(this.option);\n  },\n\n  methods: {\n    //查询\n    stop() {\n      clearInterval(this.timer);\n      this.timer = null;\n    },\n\n    // 请求是否有新消息\n    getProjectList() {\n      console.log(\"请求\" + this.num++ + \"次\");\n      this.$axios.get(\"/api/interest/backstage/15518745323\").then(response => {\n        console.log(response.data);\n        this.option.series[0].data = [];\n        let temp = {};\n\n        for (const item of response.data) {\n          temp.name = item.goodsClassify;\n          temp.value = item.grade;\n          this.option.series[0].data.push(temp);\n          temp = {};\n        }\n\n        var chartDom = document.getElementById(\"main\");\n        var myChart = this.$echarts.init(chartDom);\n        this.option && myChart.setOption(this.option);\n      }).catch(error => {});\n\n      if (this.num == 180) {\n        this.stop();\n      }\n    },\n\n    change() {\n      // 修改数据\n      this.option.series[0].data[0].value += 10; //  页面更新\n\n      var chartDom = document.getElementById(\"main\");\n      var myChart = this.$echarts.init(chartDom);\n      this.option && myChart.setOption(this.option);\n    }\n\n  },\n\n  destroyed() {\n    //离开页面是销毁\n    clearInterval(this.timer);\n    this.timer = null;\n  }\n\n};","map":{"version":3,"mappings":";AAWA;EACAA;IACA;MACA;MACAC,MAFA;MAGAC,WAHA;MAIA;MACAC,QALA;MAOA;MACAC;QACA;QACAC;UACAC,qBADA;UAEAC,gBAFA;UAGAC;QAHA,CAFA;QAOAC;UACAC;QADA,CAPA;QAUAC;UACAC,kBADA;UAEAJ;QAFA,CAVA;QAcAK,SACA;UACAC,mBADA;UAEAC,WAFA;UAGAC,aAHA;UAIAhB,QAJA;UAKAiB;YACAC;cACAC,cADA;cAEAC,gBAFA;cAGAC;YAHA;UADA;QALA,CADA;MAdA;IARA;EAuCA,CAzCA;;EA2CAC;IACAC,gBADA,CAEA;IACA;;IAEA,YACAC,GADA,CACA,qCADA,EAEAC,IAFA,CAEAC;MACAH;MACA;;MACA;QACAI;QACAA;QACA;QACAA;MACA;;MACA;MACA;MACA;IACA,CAdA,EAeAC,KAfA,CAeAC,WAfA,EALA,CAsBA;;IACA;MACAC;IACA,CAFA,EAEA,IAFA;EAGA,CArEA;;EAuEAC;IACA;IACA;IACA;EACA,CA3EA;;EA6EAC;IACA;IACAC;MACAC;MACA;IACA,CALA;;IAOA;IACAC;MACAZ;MACA,YACAC,GADA,CACA,qCADA,EAEAC,IAFA,CAEAC;QACAH;QACA;QACA;;QACA;UACAI;UACAA;UACA;UACAA;QACA;;QACA;QACA;QACA;MACA,CAfA,EAgBAC,KAhBA,CAgBAC,WAhBA;;MAiBA;QACA;MACA;IACA,CA9BA;;IAgCAO;MACA;MACA,0CAFA,CAGA;;MACA;MACA;MACA;IACA;;EAvCA,CA7EA;;EAuHAC;IACA;IACAH;IACA;EACA;;AA3HA","names":["data","num","timer","user","option","title","text","subtext","left","tooltip","trigger","legend","orient","series","name","type","radius","emphasis","itemStyle","shadowBlur","shadowOffsetX","shadowColor","created","console","get","then","response","temp","catch","error","setTimeout","mounted","methods","stop","clearInterval","getProjectList","change","destroyed"],"sourceRoot":"src/views/user","sources":["UserInterest.vue"],"sourcesContent":["<template>\r\n   <div class=\"container\">\r\n      测试页面\r\n      <hr />\r\n      <div\r\n         style=\"width: 700px; height: 700px; border: 1px solid red\" id=\"main\"></div>\r\n      <button @click=\"change\">修改</button>\r\n   </div>\r\n</template>\r\n \r\n <script>\r\nexport default {\r\n   data() {\r\n      return {\r\n         //定时器\r\n         num: 0,\r\n         timer: null,\r\n         //用户信息\r\n         user: {},\r\n\r\n         // echarts的数据配置项\r\n         option: {\r\n            // 中间大标题\r\n            title: {\r\n               text: \"用户15518745323\",\r\n               subtext: \"购买倾向图\",\r\n               left: \"center\",\r\n            },\r\n            tooltip: {\r\n               trigger: \"item\",\r\n            },\r\n            legend: {\r\n               orient: \"vertical\",\r\n               left: \"left\",\r\n            },\r\n            series: [\r\n               {\r\n                  name: \"Access From\",\r\n                  type: \"pie\",\r\n                  radius: \"50%\",\r\n                  data: [],\r\n                  emphasis: {\r\n                     itemStyle: {\r\n                        shadowBlur: 10,\r\n                        shadowOffsetX: 0,\r\n                        shadowColor: \"rgba(0, 0, 0, 0.5)\",\r\n                     },\r\n                  },\r\n               },\r\n            ],\r\n         },\r\n      };\r\n   },\r\n\r\n   created() {\r\n      console.log(\"\");\r\n      //获取用户信息:\r\n      //   this.user = this.$qs.parse(window.sessionStorage.getItem(\"userinfo\"));\r\n\r\n      this.$axios\r\n         .get(\"/api/interest/backstage/15518745323\")\r\n         .then((response) => {\r\n            console.log(response.data);\r\n            let temp = {};\r\n            for (const item of response.data) {\r\n               temp.name = item.goodsClassify;\r\n               temp.value = item.grade;\r\n               this.option.series[0].data.push(temp);\r\n               temp = {};\r\n            }\r\n            var chartDom = document.getElementById(\"main\");\r\n            var myChart = this.$echarts.init(chartDom);\r\n            this.option && myChart.setOption(this.option);\r\n         })\r\n         .catch((error) => {});\r\n\r\n      // 实现轮询\r\n      this.timer = window.setInterval(() => {\r\n         setTimeout(this.getProjectList(), 0);\r\n      }, 1000);\r\n   },\r\n\r\n   mounted() {\r\n      var chartDom = document.getElementById(\"main\");\r\n      var myChart = this.$echarts.init(chartDom);\r\n      this.option && myChart.setOption(this.option);\r\n   },\r\n\r\n   methods: {\r\n      //查询\r\n      stop() {\r\n         clearInterval(this.timer);\r\n         this.timer = null;\r\n      },\r\n\r\n      // 请求是否有新消息\r\n      getProjectList() {\r\n         console.log(\"请求\" + this.num++ + \"次\");\r\n         this.$axios\r\n            .get(\"/api/interest/backstage/15518745323\")\r\n            .then((response) => {\r\n               console.log(response.data);\r\n               this.option.series[0].data = [];\r\n               let temp = {};\r\n               for (const item of response.data) {\r\n                  temp.name = item.goodsClassify;\r\n                  temp.value = item.grade;\r\n                  this.option.series[0].data.push(temp);\r\n                  temp = {};\r\n               }\r\n               var chartDom = document.getElementById(\"main\");\r\n               var myChart = this.$echarts.init(chartDom);\r\n               this.option && myChart.setOption(this.option);\r\n            })\r\n            .catch((error) => {});\r\n         if (this.num == 180) {\r\n            this.stop();\r\n         }\r\n      },\r\n\r\n      change() {\r\n         // 修改数据\r\n         this.option.series[0].data[0].value += 10;\r\n         //  页面更新\r\n         var chartDom = document.getElementById(\"main\");\r\n         var myChart = this.$echarts.init(chartDom);\r\n         this.option && myChart.setOption(this.option);\r\n      },\r\n   },\r\n\r\n   destroyed() {\r\n      //离开页面是销毁\r\n      clearInterval(this.timer);\r\n      this.timer = null;\r\n   },\r\n};\r\n</script>\r\n \r\n <style scoped></style>"]},"metadata":{},"sourceType":"module"}